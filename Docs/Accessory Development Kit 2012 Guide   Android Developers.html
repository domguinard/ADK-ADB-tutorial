<!DOCTYPE html>
<!-- saved from url=(0048)http://developer.android.com/tools/adk/adk2.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">





<link rel="shortcut icon" type="image/x-icon" href="http://developer.android.com/favicon.ico">
<title>Accessory Development Kit 2012 Guide | Android Developers</title>

<!-- STYLESHEETS -->
<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Roboto:regular,medium,thin,italic,mediumitalic,bold" title="roboto">
<link href="./Accessory Development Kit 2012 Guide   Android Developers_files/default.css" rel="stylesheet" type="text/css">



<!-- JAVASCRIPT -->
<script src="./Accessory Development Kit 2012 Guide   Android Developers_files/cb=gapi.loaded_0" async=""></script><script type="text/javascript" async="" src="./Accessory Development Kit 2012 Guide   Android Developers_files/plusone.js" gapi_processed="true"></script><script type="text/javascript" async="" src="./Accessory Development Kit 2012 Guide   Android Developers_files/ga.js"></script><script src="./Accessory Development Kit 2012 Guide   Android Developers_files/jsapi" type="text/javascript"></script>
<script src="./Accessory Development Kit 2012 Guide   Android Developers_files/android_3p-bundle.js" type="text/javascript"></script>
<script type="text/javascript">
  var toRoot = "/";
  var devsite = false;
</script>
<script src="./Accessory Development Kit 2012 Guide   Android Developers_files/docs.js" type="text/javascript"></script><script type="text/javascript" src="./Accessory Development Kit 2012 Guide   Android Developers_files/saved_resource"></script>

<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-5831155-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
<link type="text/css" href="./Accessory Development Kit 2012 Guide   Android Developers_files/default+en.css" rel="stylesheet"><script type="text/javascript" src="./Accessory Development Kit 2012 Guide   Android Developers_files/default+en.I.js"></script></head>
<body class="gc-documentation 
  develop" itemscope="" itemtype="http://schema.org/Article">

<a name="top"></a>

    <!-- Header -->
    <div id="header">
        <div class="wrap" id="header-wrap">
          <div class="col-3 logo">
          <a href="http://developer.android.com/index.html">
            <img src="./Accessory Development Kit 2012 Guide   Android Developers_files/dac_logo.png" width="123" height="25" alt="Android Developers">
          </a>
          <div class="btn-quicknav" id="btn-quicknav">
          	<a href="http://developer.android.com/tools/adk/adk2.html#" class="arrow-inactive">Quicknav</a>
			      <a href="http://developer.android.com/tools/adk/adk2.html#" class="arrow-active">Quicknav</a>
          </div>
          </div>
            <ul class="nav-x col-9">
                <li class="design">
                  <a href="http://developer.android.com/design/index.html" zh-tw-lang="設計" zh-cn-lang="设计" ru-lang="Проектирование" ko-lang="디자인" ja-lang="設計" es-lang="Diseñar">Design</a></li>
                <li class="develop"><a href="http://developer.android.com/develop/index.html" zh-tw-lang="開發" zh-cn-lang="开发" ru-lang="Разработка" ko-lang="개발" ja-lang="開発" es-lang="Desarrollar" class="selected">Develop</a></li>
                <li class="distribute last"><a href="http://developer.android.com/distribute/index.html" zh-tw-lang="發佈" zh-cn-lang="分发" ru-lang="Распространение" ko-lang="배포" ja-lang="配布" es-lang="Distribuir">Distribute</a></li>
            </ul>
            
            <!-- New Search -->
            <div class="menu-container">
            <div class="moremenu">
    <div id="more-btn"></div>
  </div>
  <div class="morehover" id="moremenu">
    <div class="top"></div>
    <div class="mid">
      <div class="header">Links</div>
      <ul>
        <li><a href="https://play.google.com/apps/publish/">Google Play Developer Console</a></li>
        <li><a href="http://android-developers.blogspot.com/">Android Developers Blog</a></li>
        <li><a href="http://developer.android.com/about/index.html">About Android</a></li>
      </ul>
      <div class="header">Android Sites</div>
      <ul>
        <li><a href="http://www.android.com/">Android.com</a></li>
        <li class="active"><a>Android Developers</a></li>
        <li><a href="http://source.android.com/">Android Open Source Project</a></li>
      </ul>
      
      
      
        <div class="header">Language</div>
          <div id="language" class="locales">
            <select name="language" onchange="changeLangPref(this.value, true)">
                <option value="en" selected="selected">English</option>
                <option value="es">Español</option>
                <option value="ja">日本語</option>
                <option value="ko">한국어</option>
                <option value="ru">Русский</option>
                <option value="zh-cn">中文 (中国)</option>
                <option value="zh-tw">中文 (台灣)</option>
            </select>
          </div>
        <script type="text/javascript">
          <!--
          loadLangPref();
            //-->
        </script>
      
      


      <br class="clearfix">
    </div>
    <div class="bottom"></div>
  </div>
  <div class="search" id="search-container">
    <div class="search-inner">
      <div id="search-btn"></div>
      <div class="left"></div>
      <form onsubmit="return submit_search()">
        <input id="search_autocomplete" type="text" value="" autocomplete="off" name="q" onfocus="search_focus_changed(this, true)" onblur="search_focus_changed(this, false)" onkeydown="return search_changed(event, true, &#39;/&#39;)" onkeyup="return search_changed(event, false, &#39;/&#39;)">
      </form>
      <div class="right"></div>
        <a class="close hide">close</a>
        <div class="left"></div>
        <div class="right"></div>
    </div>
  </div>

  <div class="search_filtered_wrapper reference">
    <div class="suggest-card reference no-display">
      <ul class="search_filtered">
      </ul>
    </div>
  </div>

  <div class="search_filtered_wrapper docs">
    <div class="suggest-card dummy no-display">&nbsp;</div>
    <div class="suggest-card develop no-display">
      <ul class="search_filtered">
      </ul>
      <div class="child-card guides no-display">
      </div>
      <div class="child-card training no-display">
      </div>
    </div>
    <div class="suggest-card design no-display">
      <ul class="search_filtered">
      </ul>
    </div>
    <div class="suggest-card distribute no-display">
      <ul class="search_filtered">
      </ul>
    </div>
  </div>

  </div>
  <!-- /New Search>
          
          
          <!-- Expanded quicknav -->
           <div id="quicknav" class="col-9">
                <ul>
                    <li class="design">
                      <ul>
                        <li><a href="http://developer.android.com/design/index.html">Get Started</a></li>
                        <li><a href="http://developer.android.com/design/style/index.html">Style</a></li>
                        <li><a href="http://developer.android.com/design/patterns/index.html">Patterns</a></li>
                        <li><a href="http://developer.android.com/design/building-blocks/index.html">Building Blocks</a></li>
                        <li><a href="http://developer.android.com/design/downloads/index.html">Downloads</a></li>
                        <li><a href="http://developer.android.com/design/videos/index.html">Videos</a></li>
                      </ul>
                    </li>
                    <li class="develop">
                      <ul>
                        <li><a href="http://developer.android.com/training/index.html" zh-tw-lang="訓練課程" zh-cn-lang="培训" ru-lang="Курсы" ko-lang="교육" ja-lang="トレーニング" es-lang="Capacitación" class="selected">Training</a></li>
                        <li><a href="http://developer.android.com/guide/components/index.html" zh-tw-lang="API 指南" zh-cn-lang="API 指南" ru-lang="Руководства по API" ko-lang="API 가이드" ja-lang="API ガイド" es-lang="Guías de la API" class="selected">API Guides</a></li>
                        <li><a href="http://developer.android.com/reference/packages.html" zh-tw-lang="參考資源" zh-cn-lang="参考" ru-lang="Справочник" ko-lang="참조문서" ja-lang="リファレンス" es-lang="Referencia" class="selected">Reference</a></li>
                        <li><a href="http://developer.android.com/tools/index.html" zh-tw-lang="相關工具" zh-cn-lang="工具" ru-lang="Инструменты" ko-lang="도구" ja-lang="ツール" es-lang="Herramientas" class="selected">Tools</a>
                          <ul><li><a href="http://developer.android.com/sdk/index.html" class="selected">Get the SDK</a></li></ul>
                        </li>
                        <li><a href="http://developer.android.com/google/index.html" class="selected">Google Services</a>
                        </li>
                      </ul>
                    </li>
                    <li class="distribute last">
                      <ul>
                        <li><a href="http://developer.android.com/distribute/index.html">Google Play</a></li>
                        <li><a href="http://developer.android.com/distribute/googleplay/publish/index.html">Publishing</a></li>
                        <li><a href="http://developer.android.com/distribute/googleplay/promote/index.html">Promoting</a></li>
                        <li><a href="http://developer.android.com/distribute/googleplay/quality/index.html">App Quality</a></li>
                        <li><a href="http://developer.android.com/distribute/googleplay/spotlight/index.html">Spotlight</a></li>
                        <li><a href="http://developer.android.com/distribute/open.html">Open Distribution</a></li>
                      </ul>
                    </li>
                </ul>
          </div>
          <!-- /Expanded quicknav -->
        </div>
    </div>
    <!-- /Header -->
    
    
  <div id="searchResults" class="wrap" style="display: none;">
          <h2 id="searchTitle" style="margin-bottom: 0px;">Results</h2><hr>
          <div id="leftSearchControl" class="search-control">Loading...</div>
  </div>
    
    
  
    <!-- Secondary x-nav -->
    <div id="nav-x">
        <div class="wrap">
            <ul class="nav-x col-9 develop" style="width:100%">
                <li class="training"><a href="http://developer.android.com/training/index.html" zh-tw-lang="訓練課程" zh-cn-lang="培训" ru-lang="Курсы" ko-lang="교육" ja-lang="トレーニング" es-lang="Capacitación">Training</a></li>
                <li class="guide"><a href="http://developer.android.com/guide/components/index.html" zh-tw-lang="API 指南" zh-cn-lang="API 指南" ru-lang="Руководства по API" ko-lang="API 가이드" ja-lang="API ガイド" es-lang="Guías de la API">API Guides</a></li>
                <li class="reference"><a href="http://developer.android.com/reference/packages.html" zh-tw-lang="參考資源" zh-cn-lang="参考" ru-lang="Справочник" ko-lang="참조문서" ja-lang="リファレンス" es-lang="Referencia">Reference</a></li>
                <li class="tools"><a href="http://developer.android.com/tools/index.html" zh-tw-lang="相關工具" zh-cn-lang="工具" ru-lang="Инструменты" ko-lang="도구" ja-lang="ツール" es-lang="Herramientas" class="selected">Tools</a></li>
                <li class="google"><a href="http://developer.android.com/google/index.html">Google Services</a>
                </li>
            </ul>
        </div>
        
    </div>
    <!-- /Sendondary x-nav -->
  




  

  <div class="wrap clearfix" id="body-content">
    <div class="col-3" id="side-nav" itemscope="" itemtype="http://schema.org/SiteNavigationElement"><div id="devdoc-nav" class="scroll-pane" style="overflow: hidden; padding: 0px; height: 801px; left: 482.5px; width: 160px;">

<!-- nav -->



        
        
      <div class="jspContainer" style="width: 160px; height: 801px;"><div class="jspPane" style="padding: 0px; top: 0px; width: 160px;"><a class="totop" href="http://developer.android.com/tools/adk/adk2.html#top" data-g-event="left-nav-top" style="display: none; width: 156px; left: 482.5px;">to top</a><ul id="nav" style="width: 156px;">

  <li class="nav-section">
    <div class="nav-section-header empty">
        <a href="http://developer.android.com/tools/index.html"><span class="en">Developer Tools</span></a>
    </div>
  </li>

  <li class="nav-section">
    <div class="nav-section-header"><a href="http://developer.android.com/sdk/index.html"><span class="en">Download</span></a></div>
    <ul>
      <li><a href="http://developer.android.com/sdk/installing/bundle.html">
          <span class="en">Setting Up the ADT Bundle</span></a></li>

      <li class="nav-section">
        <div class="nav-section-header">
          <a href="http://developer.android.com/sdk/installing/index.html"><span class="en">Setting Up
    an Existing IDE</span></a></div>
        <ul>
          <li><a href="http://developer.android.com/sdk/installing/installing-adt.html">
              <span class="en">Installing the Eclipse Plugin</span></a></li>
        <li><a href="http://developer.android.com/sdk/installing/adding-packages.html">
            <span class="en">Adding Platforms and Packages</span></a></li>
        </ul>
      </li>

      <li class="nav-section">
        <div class="nav-section-header">
          <a href="http://developer.android.com/sdk/installing/studio.html">Android Studio</a>
        </div>
        <ul>
          <li><a href="http://developer.android.com/sdk/installing/migrate.html">
              Migrating from Eclipse</a></li>
          <li><a href="http://developer.android.com/sdk/installing/studio-tips.html">
              Tips and Tricks</a></li>
        </ul>
      </li>
      <li><a href="http://developer.android.com/sdk/exploring.html">
          <span class="en">Exploring the SDK</span></a></li>
      <li><a href="http://developer.android.com/tools/sdk/ndk/index.html">Download the NDK</a>
      </li>
    </ul>
  </li>

  <li class="nav-section">
    <div class="nav-section-header">
        <a href="http://developer.android.com/tools/workflow/index.html"><span class="en">Workflow</span></a>
    </div>
    <ul>
      <li class="nav-section">
        <div class="nav-section-header"><a href="http://developer.android.com/tools/devices/index.html"><span class="en">Setting Up Virtual Devices</span></a></div>
        <ul>
          <li><a href="http://developer.android.com/tools/devices/managing-avds.html"><span class="en">With AVD Manager</span></a></li>
          <li><a href="http://developer.android.com/tools/devices/managing-avds-cmdline.html"><span class="en">From the Command Line</span></a></li>
          <li><a href="http://developer.android.com/tools/devices/emulator.html"><span class="en">Using the Emulator</span></a></li>
        </ul>
      </li>
      <li><a href="http://developer.android.com/tools/device.html"><span class="en">Using Hardware Devices</span></a></li>
      <li class="nav-section">
        <div class="nav-section-header"><a href="http://developer.android.com/tools/projects/index.html"><span class="en">Setting Up Projects</span></a></div>
        <ul>
          <li><a href="http://developer.android.com/tools/projects/projects-eclipse.html"><span class="en">From Eclipse with ADT</span></a></li>
          <li><a href="http://developer.android.com/tools/projects/projects-cmdline.html"><span class="en">From the Command Line</span></a></li>
          <li><a href="http://developer.android.com/tools/projects/templates.html"><span class="en">Using Code Templates</span></a></li>
        </ul>
      </li>


      <li class="nav-section">
        <div class="nav-section-header"><a href="http://developer.android.com/tools/building/index.html"><span class="en">Building and Running</span></a></div>
        <ul>
          <li><a href="http://developer.android.com/tools/building/building-eclipse.html"><span class="en">From Eclipse with ADT</span></a></li>
          <li><a href="http://developer.android.com/tools/building/building-cmdline.html"><span class="en">From the Command Line</span></a></li>
        </ul>
      </li>


  <li class="nav-section">
        <div class="nav-section-header"><a href="http://developer.android.com/tools/testing/index.html">
            <span class="en">Testing</span>
          </a></div>
        <ul>
          <li>
            <a href="http://developer.android.com/tools/testing/testing_android.html">
            <span class="en">Fundamentals</span></a>
          </li>
          <li><a href="http://developer.android.com/tools/testing/testing_eclipse.html">
            <span class="en">From Eclipse</span></a>
          </li>
          <li><a href="http://developer.android.com/tools/testing/testing_otheride.html">
            <span class="en">From Other IDEs</span></a>
          </li>
          <li>
            <a href="http://developer.android.com/tools/testing/activity_testing.html">
            <span class="en">Activity Testing</span></a>
          </li>
          <li>
            <a href="http://developer.android.com/tools/testing/service_testing.html">
            <span class="en">Service Testing</span></a>
          </li>
          <li>
            <a href="http://developer.android.com/tools/testing/contentprovider_testing.html">
            <span class="en">Content Provider Testing</span></a>
          </li>
          <li>
            <a href="http://developer.android.com/tools/testing/testing_accessibility.html">
            <span class="en">Accessibility Testing</span></a>
          </li>
           <li>
            <a href="http://developer.android.com/tools/testing/testing_ui.html">
            <span class="en">UI Testing</span></a>
          </li>
          <li>
            <a href="http://developer.android.com/tools/testing/what_to_test.html">
            <span class="en">What To Test</span></a>
          </li>
          <li>
            <a href="http://developer.android.com/tools/testing/activity_test.html">
            <span class="en">Activity Testing Tutorial</span></a>
          </li>
        </ul>
  </li><!-- end of testing -->

  <li class="nav-section">
    <div class="nav-section-header"><a href="http://developer.android.com/tools/debugging/index.html"><span class="en">Debugging</span></a></div>
    <ul>
      <li><a href="http://developer.android.com/tools/debugging/debugging-projects.html"><span class="en">From Eclipse with ADT</span></a></li>
      <li><a href="http://developer.android.com/tools/debugging/debugging-projects-cmdline.html"><span class="en">From Other IDEs</span></a></li>
      <li><a href="http://developer.android.com/tools/debugging/ddms.html"><span class="en">Using DDMS</span></a></li>
      <li><a href="http://developer.android.com/tools/debugging/debugging-log.html"><span class="en">Reading and Writing Logs</span></a></li>
      <li><a href="http://developer.android.com/tools/debugging/improving-w-lint.html"><span class="en">Improving Your Code with lint</span></a></li>
      <li><a href="http://developer.android.com/tools/debugging/debugging-ui.html"><span class="en">Optimizing your UI</span></a></li>
      <li><a href="http://developer.android.com/tools/debugging/debugging-tracing.html"><span class="en">Profiling with Traceview and dmtracedump</span></a></li>
      <li><a href="http://developer.android.com/tools/debugging/systrace.html"><span class="en">Analysing Display and Performance with Systrace</span></a></li>
      <li><a href="http://developer.android.com/tools/debugging/debugging-devtools.html"><span class="en">Using the Dev Tools App</span></a></li>
    </ul>
  </li>
      <li class="nav-section">
        <div class="nav-section-header"><a href="http://developer.android.com/tools/publishing/publishing_overview.html"><span class="en">Publishing</span></a></div>
        <ul>
          <li><a href="http://developer.android.com/tools/publishing/preparing.html"><span class="en">Preparing for Release</span></a></li>
          <li><a href="http://developer.android.com/tools/publishing/versioning.html"><span class="en">Versioning Your Apps</span></a></li>
          <li><a href="http://developer.android.com/tools/publishing/app-signing.html"><span class="en">Signing Your Apps</span></a></li>
        </ul>
      </li>
</ul>
</li>
  <li class="nav-section">
    <div class="nav-section-header"><a href="http://developer.android.com/tools/help/index.html"><span class="en">Tools Help</span></a></div>
    <ul>
      <li><a href="http://developer.android.com/tools/help/adb.html">adb</a></li>
      <li><a href="http://developer.android.com/tools/help/adt.html">ADT</a></li>
      <li><a href="http://developer.android.com/tools/help/android.html">android</a></li>
      <li><a href="http://developer.android.com/tools/help/avd-manager.html">AVD Manager</a></li>
      <li><a href="http://developer.android.com/tools/help/bmgr.html">bmgr</a>
      </li><li><a href="http://developer.android.com/tools/help/monitor.html">Device Monitor</a></li>
      <li><a href="http://developer.android.com/tools/help/dmtracedump.html">dmtracedump</a></li>
      <li><a href="http://developer.android.com/tools/help/draw9patch.html">Draw 9-Patch</a></li>
      <li><a href="http://developer.android.com/tools/help/emulator.html">Emulator</a></li>
      <li><a href="http://developer.android.com/tools/help/etc1tool.html">etc1tool</a></li>
      <li><a href="http://developer.android.com/tools/help/hierarchy-viewer.html">Hierarchy Viewer</a></li>
      <li><a href="http://developer.android.com/tools/help/hprof-conv.html">hprof-conv</a></li>
      <li><a href="http://developer.android.com/tools/help/jobb.html">jobb</a></li>
      <li><a href="http://developer.android.com/tools/help/lint.html">lint</a></li>
      <li><a href="http://developer.android.com/tools/help/logcat.html">logcat</a></li>
      <li><a href="http://developer.android.com/tools/help/mksdcard.html">mksdcard</a></li>
      <li><a href="http://developer.android.com/tools/help/monkey.html">monkey</a></li>
      <li class="nav-section">
        <div class="nav-section-header"><a href="http://developer.android.com/tools/help/monkeyrunner_concepts.html"><span class="en">monkeyrunner</span></a></div>
        <ul>
          <li><a href="http://developer.android.com/tools/help/MonkeyDevice.html"><span class="en">MonkeyDevice</span></a></li>
          <li><a href="http://developer.android.com/tools/help/MonkeyImage.html"><span class="en">MonkeyImage</span></a></li>
          <li><a href="http://developer.android.com/tools/help/MonkeyRunner.html"><span class="en">MonkeyRunner</span></a></li>
        </ul>
      </li>
       <li><a href="http://developer.android.com/tools/help/proguard.html">ProGuard</a></li>
       <li><a href="http://developer.android.com/tools/help/sdk-manager.html">SDK Manager</a></li>
       <li><a href="http://developer.android.com/tools/help/systrace.html">Systrace</a></li>
       <li><a href="http://developer.android.com/tools/help/gltracer.html">Tracer for OpenGL ES</a></li>
       <li><a href="http://developer.android.com/tools/help/traceview.html">Traceview</a></li>
       <li class="nav-section">
          <div class="nav-section-header"><a href="http://developer.android.com/tools/help/uiautomator/index.html"><span class="en">uiautomator</span></a></div>
          <ul>
             <li><a href="http://developer.android.com/tools/help/uiautomator/IAutomationSupport.html"><span class="en">IAutomationSupport</span></a></li>
             <li><a href="http://developer.android.com/tools/help/uiautomator/UiAutomatorTestCase.html"><span class="en">UiAutomatorTestCase</span></a></li>
             <li><a href="http://developer.android.com/tools/help/uiautomator/UiCollection.html"><span class="en">UiCollection</span></a></li>
             <li><a href="http://developer.android.com/tools/help/uiautomator/UiDevice.html"><span class="en">UiDevice</span></a></li>
             <li><a href="http://developer.android.com/tools/help/uiautomator/UiObject.html"><span class="en">UiObject</span></a></li>
             <li><a href="http://developer.android.com/tools/help/uiautomator/UiObjectNotFoundException.html"><span class="en">UiObjectNotFoundException</span></a></li>
             <li><a href="http://developer.android.com/tools/help/uiautomator/UiScrollable.html"><span class="en">UiScrollable</span></a></li>
             <li><a href="http://developer.android.com/tools/help/uiautomator/UiSelector.html"><span class="en">UiSelector</span></a></li>
             <li><a href="http://developer.android.com/tools/help/uiautomator/UiWatcher.html"><span class="en">UiWatcher</span></a></li>
          </ul>
       </li>
       <li><a href="http://developer.android.com/tools/help/zipalign.html">zipalign</a></li>
    </ul>
  </li>

  <li class="nav-section">
    <div class="nav-section-header"><a href="http://developer.android.com/tools/revisions/index.html"><span class="en">Revisions</span></a></div>
    <ul>
      <li><a href="http://developer.android.com/tools/sdk/tools-notes.html">
        <span class="en">Tools</span>
      </a></li>
      <li><a href="http://developer.android.com/tools/sdk/eclipse-adt.html">
        <span class="en">ADT Plugin</span>
      </a></li>
      <!--
      <li><a href="/tools/sdk/addons.html"><span class="en">Add-ons</span></a></li>
      -->
      <li><a href="http://developer.android.com/tools/revisions/platforms.html"><span class="en">Platforms</span></a></li>
    </ul>
  </li>


  <li class="nav-section">
    <div class="nav-section-header"><a href="http://developer.android.com/tools/extras/index.html"><span class="en">Extras</span></a></div>
    <ul>
      <li><a href="http://developer.android.com/tools/extras/support-library.html"><span class="en">Support
Library</span></a></li>
      <li><a href="http://developer.android.com/tools/extras/oem-usb.html"><span class="en">USB Drivers</span></a>
      </li>
    </ul>
  </li>


  <li class="nav-section">
    <div class="nav-section-header empty"><a href="http://developer.android.com/tools/samples/index.html"><span class="en">Samples</span></a></div>
  </li>


  <li class="nav-section expanded">
    <div class="nav-section-header">
    <a href="http://developer.android.com/tools/adk/index.html">
      <span class="en">ADK</span></a>
    </div>
    <ul style="display: block;">
      <li class="selected"><a href="./Accessory Development Kit 2012 Guide   Android Developers_files/Accessory Development Kit 2012 Guide   Android Developers.html">ADK 2012 Guide</a></li>
      <li><a href="http://developer.android.com/tools/adk/adk.html">ADK 2011 Guide</a></li>
    </ul>
  </li>

</ul></div></div></div>
      
    </div> <!-- end side-nav -->
    <script>
      $(document).ready(function() {
        scrollIntoView("devdoc-nav");
        });
    </script>




<div class="col-13" id="doc-col">


  
    
      
        <h1 itemprop="name">Accessory Development Kit 2012 Guide</h1>
      
    
  


  
  <div id="jd-content">


    <div class="jd-descr" itemprop="articleBody">
    <div id="qv-wrapper">
  <div id="qv">
    <h2>In this document</h2>
    <ol>
      <li><a href="http://developer.android.com/tools/adk/adk2.html#components">Components</a></li>
      <li><a href="http://developer.android.com/tools/adk/adk2.html#clock">Using the Alarm Clock</a></li>
      <li><a href="http://developer.android.com/tools/adk/adk2.html#play-audio">Playing Audio</a></li>
      <li><a href="http://developer.android.com/tools/adk/adk2.html#dev">Developing Accessories with ADK 2012</a>
        <ol>
          <li><a href="http://developer.android.com/tools/adk/adk2.html#src-download">Downloading the ADK Source</a></li>
          <li><a href="http://developer.android.com/tools/adk/adk2.html#dev-setup">Setting Up the Development Environment</a></li>
          <li><a href="http://developer.android.com/tools/adk/adk2.html#alt-build">Using the ADK Alternative Build System</a></li>
        </ol>
      </li>
      <li><a href="http://developer.android.com/tools/adk/adk2.html#adk-conn">How the ADK Connects with Android Devices</a>
        <ol>
          <li><a href="http://developer.android.com/tools/adk/adk2.html#adk-conn-bt">ADK Connection over Bluetooth</a></li>
          <li><a href="http://developer.android.com/tools/adk/adk2.html#adk-conn-usb">ADK Connection over USB</a></li>
        </ol>
      </li>
      <li><a href="http://developer.android.com/tools/adk/adk2.html#audio-dock">USB Audio Dock Implementation</a></li>
    </ol>

    <h2>See also</h2>
    <ol>
      <li><a href="https://developers.google.com/events/io/sessions/gooio2012/128/">
        Google I/O Session Video</a></li>
      <li><a href="http://source.android.com/tech/accessories/aoap/aoa.html">
        Android Open Accessory Protocol</a></li>
      <li><a href="http://source.android.com/tech/accessories/aoap/aoa2.html">
        Android Open Accessory Protocol 2.0</a></li>
      <li><a href="http://developer.android.com/guide/topics/connectivity/usb/accessory.html">
        USB Accessory Dev Guide</a></li>
    </ol>
  </div>
</div>

<p>The Android Accessory Development Kit (ADK) for 2012 is the latest reference implementation of an
<a href="http://source.android.com/tech/accessories/index.html">Android Open Accessory</a> device,
designed to help Android hardware accessory builders and software developers create accessories
for Android. The ADK 2012 is based on the <a href="http://arduino.cc/">Arduino</a> open source
electronics prototyping platform, with some hardware and software extensions that allow it to
communicate with Android devices.</p>

<p>A limited number of these kits were produced and distributed at the Google I/O 2012 developer
conference. If you did not receive one of these kits, fear not! The specifications and design files
for the hardware were also released for use by manufacturers and hobbyists. You should expect to see
kits with similar features available for purchase, or you can build one yourself!</p>

<p>One of the important new features demonstrated by this ADK is the ability to play audio over a
USB connection. Be sure to check out the <a href="http://developer.android.com/tools/adk/adk2.html#audio-dock">reference implementation</a> of a USB
audio dock in this ADK if you are interested in making audio-related USB accessories for
Android.</p>

<h2 id="components" style="margin-bottom: 0px;">Components</h2><hr>

<p>The ADK 2012 is based on the Arduino open source electronics prototyping platform and is an open
hardware design. The hardware design files and firmware source code are included with the ADK
software download. The ADK contains two main physical hardware components:</p>

<ol>
  <li>Main processing board containing the microprocessor, USB connections, power connector and
input/output pins. This board can be removed and used separately from the rest of the hardware.</li>
  <li>Shield containing sensors, LEDs, input controls, audio amplifier and speaker output, contained
in a custom, polygon box enclosure.</li>
</ol>

<p>The main hardware features of the ADK are as follows:</p>

<ul>
  <li>An ARM 32-bit Cortex M3 micro-processor</li>
  <li>Separate USB connections for an Android device and computer connection for programming and
debugging</li>
  <li>Sensors for light, color, proximity, temperature, humidity, barometric pressure, and
acceleration</li>
  <li>Micro SD Card slot</li>
  <li>Bluetooth support</li>
</ul>

<p>The ADK comes preloaded with an alarm clock firmware program that you can use immediately. A
companion Android application, <a href="https://play.google.com/store/apps/details?id=com.google.android.apps.adk2">ADK 2012</a>, is
available on Google Play. The source code for both the Android application and the ADK firmware (an
Arduino sketch) can be downloaded from this page.</p>

<p>The ADK 2012 also comes with additional parts to help you develop accessories with it,
including:</p>

<ul>
  <li>AC power adapter</li>
  <li>USB A to Micro USB B connector cable</li>
  <li>Micro USB B to Micro USB AB connector (small, rectangular plug)</li>
  <li>Micro SD Card, preinstalled in the ADK SD Card socket</li>
</ul>

<h2 id="clock" style="margin-bottom: 0px;">Using the Alarm Clock</h2><hr>

<p>An alarm clock program comes preloaded on the ADK. This firmware program allows you to use the
ADK as an alarm clock.</p>

<p>To use the ADK as an alarm clock:</p>

<ol>
  <li>Open up the ADK by gently squeezing the two widest faces of the enclosure.</li>
  <li>Attach the provided AC power adapter (round connector) to the main ADK board, or attach a USB
cable to the port marked <strong>Computer</strong> and a USB port on your computer.</li>
  <li>Place and hold your fingertip over the clock symbol on the control face.
    <p class="note"><strong>Note:</strong> You may need to hold your finger in place for 1-2
seconds.</p>
  </li>
  <li>Use the plus (+) and minus (-) symbols inside the clock digits to set the correct time.</li>
  <li>Place your fingertip over the alarm clock symbol to activate alarm setting.</li>
  <li>Use the plus (+) and minus (-) symbols inside the clock digits to set the alarm time.</li>
  <li>Use the plus (+) and minus (-) symbols inside the last two clock digits to turn the alarm on
(<code>on</code>) or off (<code>oF</code>).</li>
  <li>To set the alarm tone, place and hold your fingertip over the alarm clock symbol, then tap the
slider control on top of the enclosure.</li>
</ol>

<p>To use the <strong>ADK 2012</strong> companion application for the alarm clock:</p>

<ol>
  <li>Load the companion application on your Android device running Android 3.1 (API Level 12) or
higher:
    <ul>
      <li>Using an NFC-enabled Android device, unlock and hold the device against the left side of
the ADK enclosure. Follow the prompts to install the app.
      <br>- or -</li>
      <li>Start Google Play on your device, search for the <strong>ADK 2012</strong> application and
install it. If you cannot find the app, your device is not compatible. Try installing on another
device.</li>
    </ul>
  </li>
  <li>Connect your Android device to the ADK using one of the following methods:
    <ul>
      <li id="conn-bt">To connect using Bluetooth:
        <ol>
          <li>Plug the AC power adapter into the ADK.</li>
          <li>On your Android device, turn Bluetooth On (<strong>Settings &gt;
Bluetooth</strong>).</li>
          <li>In the <strong>Settings</strong> page, press the <strong>Bluetooth</strong> option to
view paired devices.</li>
          <li>Select <strong>Search for Devices</strong> to locate the ADK 2012 accessory and follow
the on screen instructions to connect.</li>
          <li>After pairing is complete, start the <strong>ADK 2012</strong> app on your Android
device.</li>
          <li>On the start screen, select the <strong>Use Bluetooth</strong> button.</li>
          <li>In the list of paired devices, select the <strong>ADK 2012</strong> device.</li>
          <li>The <strong>ADK 2012</strong> app should switch to the menu screen and you can start
interacting with the ADK accessory.</li>
        </ol>
      </li>

      <li id="conn-usb">To connect using USB:
        <ol>
          <li>Plug the AC power adapter into the ADK.</li>
          <li>Connect the Micro USB AB connector (small, rectangular plug) to the port labeled
<strong>Phone</strong> on the ADK board.</li>
          <li>Unlock your Android device and connect the Micro USB B connector to your device.
            <p class="note"><strong>Note:</strong> Your device must support Android USB accessory
mode. Devices that support this mode include Google Nexus devices.</p>
          </li>
          <li>On the Android device, you should see a prompt to connect to the <strong>ADK DemoKit
2012</strong>, select <strong>OK</strong>.</li>
          <li>The <strong>ADK 2012</strong> app should start automatically and you can start
interacting with the ADK.</li>
        </ol>
      </li>
    </ul>
  </li>
</ol>

<p class="note"><strong>Note:</strong> When using the ADK with a USB connection to an Android
device, make sure the AC power adapter is plugged in. A USB connection to a computer does not
provide sufficient voltage to power both the ADK and a USB connection to a device.</p>


<h2 id="play-audio" style="margin-bottom: 0px;">Playing Audio</h2><hr>

<p>The ADK 2012 comes with audio output capabilities, including an amplifier and speaker. You can
use it to play audio from your Android device using either a Bluetooth or USB connection.</p>

<p>To play audio over Bluetooth:</p>

<ol>
  <li>Follow the instructions in the <a href="http://developer.android.com/tools/adk/adk2.html#conn-bt">previous section</a> to connect your Android
device to the ADK over Bluetooth.</li>
  <li>On your Android device, navigate to the <strong>Settings &gt; Bluetooth</strong> page to view the
list of paired devices, and make sure the ADK is connected.</li>
  <li>Select the settings icon next to the <strong>ADK 2012</strong> item.</li>
  <li>Make sure the <strong>Media Audio</strong> option is enabled.</li>
  <li>Navigate to an application that plays music or other audio.</li>
  <li>Play a song or sound and listen to it on the ADK speaker!</li>
</ol>

<p>To play audio over USB, you must use a device running Android 4.1 (API Level 16) or higher:</p>

<ol>
  <li>Plug the AC power adapter into the ADK.</li>
  <li>Connect the Micro USB AB connector (small, rectangular plug) to the Phone port on the ADK
board.</li>
  <li>Unlock your Android device and connect the Micro USB B connector to your device.
    <p class="note"><strong>Note:</strong> Your device must support Android USB accessory
mode. Devices that support this mode include Google Nexus devices.</p>
  </li>
  <li>On the Android device, you should see a prompt to connect to the <strong>ADK DemoKit
2012</strong>, select <strong>Cancel</strong> and allow the ADK to connect as a media device
only.</li>
  <li>Navigate to an application that plays music or other audio.</li>
  <li>Play a song or sound and listen to it on the ADK speaker!</li>
</ol>

<p class="note"><strong>Note:</strong> When using the ADK with a USB connection to an Android
device, make sure the AC power adapter is plugged in. A USB connection to a computer does not
provide sufficient voltage to power both the ADK and a USB connection to a device.</p>


<h2 id="dev" style="margin-bottom: 0px;">Developing Accessories with ADK 2012</h2><hr>

<p>The ADK 2012 is a hardware platform and a set of software libraries for prototyping Android
accessories. This section discusses how to set up a development environment for programming the ADK
to make it do what you want and to test software for building your own Android accessories.</p>

<h3 id="src-download">Downloading the ADK Source</h3>

<p>The support software and hardware specifications for the ADK 2012 are available from the Android
source repository. Follow the instructions below to obtain the source material for the ADK.</p>

<p>To download the ADK 2012 software, source code and hardware design specifications.</p>

<ol>
  <li>Download and install <a href="http://git-scm.com/download">Git</a> for your development
system.</li>
  <li>Download and setup the <code>repo</code> tool, as described on the <a href="http://source.android.com/source/downloading.html#installing-repo">Android open source
project</a> site.
    <p class="note"><strong>Note:</strong> Developers using Windows must use a Linux compatibility
package, such as <a href="http://www.cygwin.com/">cygwin</a>, to install and run <code>repo</code>.
Within your compatibility environment, you must install <code>curl</code>, <code>git</code> and <code>python</code> to be able to download and use the <code>repo</code> tool.</p>
  </li>
  <li>In a terminal window, create a new directory for the downloaded source files, initialize and
synchronize a local repository:
<pre class="prettyprint"><span class="pln">$</span><span class="pun">&gt;</span><span class="pln"> mkdir android</span><span class="pun">-</span><span class="pln">accessories<br>$</span><span class="pun">&gt;</span><span class="pln"> cd android</span><span class="pun">-</span><span class="pln">accessories<br>$</span><span class="pun">&gt;</span><span class="pln"> repo init </span><span class="pun">-</span><span class="pln">u https</span><span class="pun">:</span><span class="com">//android.googlesource.com/accessories/manifest</span><span class="pln"><br>$</span><span class="pun">&gt;</span><span class="pln"> repo sync</span></pre>
  </li>
</ol>

<p>After successfully completing this process, you should have the source code and tools for
working with the ADK 2012:</p>

<ul>
  <li><code>adk2012/board</code> - Source code and hardware design files for the ADK 2012</li>
  <li><code>adk2012/app</code> - Source code for the ADK 2012 Android companion application</li>
  <li><code>external/ide</code> - Source code for the ADK 2012 Integrated Development Environment
(IDE)</li>
  <li><code>external/toolchain</code> - The toolchain used by the ADK 2012 IDE</li>
</ul>


<h3 id="dev-setup">Setting Up the Development Environment</h3>

<p>The ADK 2012 comes with an integrated development environment (IDE) that you use to develop
software and program the ADK 2012 accessory. The following instructions explain how to setup and run
the ADK 2012 IDE.</p>

<p>To set up and run the ADK 2012 IDE:</p>

<ol>
  <li>Download and install the Java Development Kit 6 or higher from <a href="http://java.oracle.com/">java.oracle.com</a>.</li>
  <li>Download the ADK 2012 IDE for your development platform:
    <ul>
      <li><a href="https://dl-ssl.google.com/android/adk/adk2012_ide-win32-20120629.zip">
          Windows</a></li>
      <li><a href="https://dl-ssl.google.com/android/adk/adk2012_ide-macosx-20120626.zip">
          Mac</a></li>
      <li>Linux
        <a href="https://dl-ssl.google.com/android/adk/adk2012_ide-linux32-20120626.tgz">32bit</a>,
        <a href="https://dl-ssl.google.com/android/adk/adk2012_ide-linux64-20120626.tgz">64bit</a>
      </li>
    </ul>
  </li>
  <li>Unpack the downloaded archive.</li>
  <li>Run the application by navigating to the unpacked <code>ADK2012_IDE/</code> folder and execute
    the <code>arduino</code> file.</li>
</ol>

<p>After you have successfully installed and run the ADK 2012 IDE, you must configure it to use
the ADK 2012 library.</p>

<p>To configure the ADK 2012 IDE for use with the ADK libraries:</p>

<ol>
  <li>Start the ADK 2012 IDE and choose <strong>File &gt; Preferences</strong>.</li>
  <li>In the <strong>Preferences</strong> dialog, make a note of the <strong>Sketchbook
location</strong> directory.</li>
  <li>Copy the <code>&lt;adk-source-download&gt;/adk2012/board/library/ADK2</code> directory and its
contents into your <code>sketchbook/libraries/</code> directory, so that you create a <code>sketchbook/libraries/ADK2</code> directory.</li>
  <li>Stop and restart the <strong>ADK 2012 IDE</strong>.</li>
  <li>In the IDE, choose <strong>File &gt; Examples &gt; ADK2</strong> and then choose one of the example
sketches:
    <ul>
      <li><strong>clock</strong> - The sketch that is preloaded onto the ADK 2012.</li>
      <li><strong>BluetoothScan</strong> - An example sketch demonstrating code that connects an
accessory to an Android device over Bluetooth.</li>
      <li><strong>usbaccessory</strong> - An example sketch demonstrating code that connects an
accessory to an Android device through a USB cable.</li>
    </ul>
  </li>
  <li>Connect a Micro USB cable from the <strong>Computer</strong> port on the ADK board to your
development computer.</li>
  <li>In the <strong>ADK 2012 IDE</strong>, establish a serial port connection with the ADK by
selecting <strong>Tools &gt; Serial Port</strong> and selecting the serial port for the ADK.</li>
  <li>In the <strong>ADK 2012 IDE</strong>, choose the ADK by selecting<strong>Tools &gt; Board &gt;
Google ADK2</strong>.</li>
  <li>Modify an example sketch or create your own.</li>
  <li>Upload the sketch to the ADK by choosing <strong>File &gt; Upload</strong>. When the <strong>ADK
2012 IDE</strong> reports <strong>Done uploading</strong>, the sketch is uploaded and the ADK is
ready to communicate with your Android device.</li>
</ol>

<h3 id="alt-build">Using the ADK Alternative Build System</h3>

<p>An alternative, make file-based build and upload system is also available for the ADK 2012. This
system is command line based and intended for production environments where using an IDE environment
to load software onto accessory hardware may be inconvenient or undesirable.</p>

<p>To setup the environment:</p>
<ol>
  <li><a href="http://developer.android.com/tools/adk/adk2.html#src-download">Download</a> the ADK 2012 source code files.</li>
  <li>In a terminal window, navigate to <code>&lt;adk-source-download&gt;/adk2012/board/MakefileBasedBuild</code>.</li>
  <li>Execute the following command and follow the instructions:
    <pre class="prettyprint"><span class="pln">$</span><span class="pun">&gt;</span><span class="pln"> </span><span class="pun">./</span><span class="pln">setup</span></pre>
  </li>
</ol>

<p>To build a program for your accessory:</p>
<ol>
  <li>Place your accessory code in the <code>MakefileBasedBuild/app</code> directory, including all
required library files. See the <code>app/main.c</code> file for an example of the program format.</li>
  <li>Execute the following command and follow the instructions:
    <pre class="prettyprint"><span class="pln">$</span><span class="pun">&gt;</span><span class="pln"> </span><span class="pun">./</span><span class="pln">build</span></pre>
  </li>
</ol>

<p>To load the program on your accessory hardware:</p>
<ol>
  <li>Run the build process above and make sure your program compiled successfully.</li>
  <li>Attach the accessory via USB cable to your development computer.</li>
  <li>Check which port the accessory is attached to and modify the <code>UART</code> variable in the
<code>flash</code> script to the correct port address. On linux machines, the port address is typically
<code>/dev/ttyUSB0</code>.</li>
  <li>Execute the following command to load the program on the accessory:
  <pre class="prettyprint"><span class="pln">$</span><span class="pun">&gt;</span><span class="pln"> </span><span class="pun">./</span><span class="pln">flash</span></pre></li>
</ol>

<h2 id="adk-conn" style="margin-bottom: 0px;">How the ADK Connects with Android Devices</h2><hr>

<p>The essential feature of any Android accessory is its ability to connect and communicate with an
Android device. Creating a fast and reliable connection between your accessory and Android devices
is the first order of business when building software for an accessory. This section describes the
connection and communication essentials used in the ADK 2012 so that you can apply them to
developing your own Android accessories.</p>

<h3 id="adk-conn-bt">ADK Connection over Bluetooth</h3>

<p>The ADK 2012 app and hardware accessory use a Bluetooth Serial Port Profile (SPP) connection to
communicate. This connection allows two way communication between the ADK accessory and Android
devices.</p>

<p class="note"><strong>Note:</strong> The implementation of the ADK hardware allows the use of
other profiles and multiple connections. However, the basic communication between the ADK 2012
accessory and the Android application uses SPP.</p>

<h4 id="acc-bt-code">Accessory Bluetooth Code</h4>

<p>In order to enable Bluetooth communications, the <code>clock.ino</code> sketch for the ADK 2012
accessory calls a <code>btStart()</code> method during the <code>setup()</code> method to enable radio
frequency communications and start listening for Bluetooth connections:</p>

<pre class="prettyprint"><span class="pln">ADK L</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">void</span><span class="pln"> setup</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp;L</span><span class="pun">.</span><span class="pln">adkInit</span><span class="pun">();</span><span class="pln"><br>&nbsp;L</span><span class="pun">.</span><span class="pln">btStart</span><span class="pun">();</span><span class="pln"><br></span><span class="pun">}</span><span class="pln"><br></span><span class="pun">...</span><span class="pln"><br></span><span class="kwd">void</span><span class="pln"> btStart</span><span class="pun">(){</span><span class="pln"><br>&nbsp; &nbsp; uint8_t i</span><span class="pun">,</span><span class="pln"> dlci</span><span class="pun">;</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">int</span><span class="pln"> f</span><span class="pun">;</span><span class="pln"><br><br>&nbsp; &nbsp; L</span><span class="pun">.</span><span class="pln">btEnable</span><span class="pun">(</span><span class="pln">adkBtConnectionRequest</span><span class="pun">,</span><span class="pln"> adkBtLinkKeyRequest</span><span class="pun">,</span><span class="pln"> adkBtLinkKeyCreated</span><span class="pun">,</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;adkBtPinRequest</span><span class="pun">,</span><span class="pln"> NULL</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; dlci </span><span class="pun">=</span><span class="pln"> L</span><span class="pun">.</span><span class="pln">btRfcommReserveDlci</span><span class="pun">(</span><span class="pln">RFCOMM_DLCI_NEED_EVEN</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; </span><span class="kwd">if</span><span class="pun">(!</span><span class="pln">dlci</span><span class="pun">)</span><span class="pln"> dbgPrintf</span><span class="pun">(</span><span class="str">"BTADK: failed to allocate DLCI\n"</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">else</span><span class="pun">{</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="com">//change descriptor to be valid...</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">for</span><span class="pun">(</span><span class="pln">i </span><span class="pun">=</span><span class="pln"> </span><span class="lit">0</span><span class="pun">,</span><span class="pln"> f </span><span class="pun">=</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">;</span><span class="pln"> i </span><span class="pun">&lt;</span><span class="pln"> </span><span class="kwd">sizeof</span><span class="pun">(</span><span class="pln">sdpDescrADK</span><span class="pun">);</span><span class="pln"> i</span><span class="pun">++){</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">sdpDescrADK</span><span class="pun">[</span><span class="pln">i</span><span class="pun">]</span><span class="pln"> </span><span class="pun">==</span><span class="pln"> MAGIX</span><span class="pun">){</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">f </span><span class="pun">==</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">)</span><span class="pln"> f </span><span class="pun">=</span><span class="pln"> i</span><span class="pun">;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">else</span><span class="pln"> </span><span class="kwd">break</span><span class="pun">;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">i </span><span class="pun">!=</span><span class="pln"> </span><span class="kwd">sizeof</span><span class="pun">(</span><span class="pln">sdpDescrADK</span><span class="pun">)</span><span class="pln"> </span><span class="pun">||</span><span class="pln"> f </span><span class="pun">==</span><span class="pln"> </span><span class="pun">-</span><span class="lit">1</span><span class="pun">){</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; dbgPrintf</span><span class="pun">(</span><span class="str">"BTADK: failed to find a single marker in descriptor\n"</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; L</span><span class="pun">.</span><span class="pln">btRfcommReleaseDlci</span><span class="pun">(</span><span class="pln">dlci</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="kwd">return</span><span class="pun">;</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; &nbsp; sdpDescrADK</span><span class="pun">[</span><span class="pln">f</span><span class="pun">]</span><span class="pln"> </span><span class="pun">=</span><span class="pln"> dlci </span><span class="pun">&gt;&gt;</span><span class="pln"> </span><span class="lit">1</span><span class="pun">;</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; &nbsp; dbgPrintf</span><span class="pun">(</span><span class="str">"BTADK has DLCI %u\n"</span><span class="pun">,</span><span class="pln"> dlci</span><span class="pun">);</span><span class="pln"><br><br>&nbsp; &nbsp; &nbsp; &nbsp; L</span><span class="pun">.</span><span class="pln">btRfcommRegisterPort</span><span class="pun">(</span><span class="pln">dlci</span><span class="pun">,</span><span class="pln"> btAdkPortOpen</span><span class="pun">,</span><span class="pln"> btAdkPortClose</span><span class="pun">,</span><span class="pln"> btAdkPortRx</span><span class="pun">);</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; L</span><span class="pun">.</span><span class="pln">btSdpServiceDescriptorAdd</span><span class="pun">(</span><span class="pln">sdpDescrADK</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">sizeof</span><span class="pun">(</span><span class="pln">sdpDescrADK</span><span class="pun">));</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br></span><span class="pun">}</span></pre>

<p>Notice that the <code>sdpDescrADK</code> object contains a Universally Unique Identifier (UUID) in the
variable <code>BT_ADK_UUID</code>. This identifier <em>must match</em> the device UUID provided in the
<code><a href="http://developer.android.com/reference/android/bluetooth/BluetoothSocket.html">BluetoothSocket</a></code> connection request in the Android application code.</p>

<p>Once Bluetooth is enabled with the code shown above, the accessory listens for connection
requests. The ADK library handles listening and connection details, so the accessory calls
<code>ADK::adkEventProcess()</code> once during each loop execution:</p>

<pre class="prettyprint"><span class="kwd">void</span><span class="pln"> loop</span><span class="pun">(</span><span class="kwd">void</span><span class="pun">)</span><span class="pln"><br></span><span class="pun">{</span><span class="pln"><br>&nbsp; </span><span class="pun">...</span><span class="pln"><br>&nbsp; L</span><span class="pun">.</span><span class="pln">adkEventProcess</span><span class="pun">();</span><span class="pln"> </span><span class="com">//let the adk framework do its thing</span><span class="pln"><br>&nbsp; </span><span class="pun">...</span><span class="pln"><br></span><span class="pun">}</span></pre>

<p>If a Bluetooth connection has been established, any commands are routed to the
<code>btAdkPortRx()</code> callback method (which was registered with the ADK library as part of the
<code>btStart()</code> method) and processed accordingly. The ADK accessory sends messages back through
the Bluetooth connection using the <code>ADK::btRfcommPortTx()</code> method.
For more details, review the implementations of these methods in the <code>clock.ino</code> sketch.</p>

<h4 id="app-bt-code">Android App Bluetooth Code</h4>

<p>In the ADK 2012 Android app, the code for handling Bluetooth connections is encapsulated in in a
<code>BTConnection</code> class. In this class, the application requests access to the Bluetooth adapter
and negotiates a connection with the ADK 2012 accessory. Here is a summary of the relevant code:</p>

<pre class="prettyprint"><span class="pln">mAdapter </span><span class="pun">=</span><span class="pln"> </span><span class="typ">BluetoothAdapter</span><span class="pun">.</span><span class="pln">getDefaultAdapter</span><span class="pun">();</span><span class="pln"><br></span><span class="typ">BluetoothDevice</span><span class="pln"> device </span><span class="pun">=</span><span class="pln"> mAdapter</span><span class="pun">.</span><span class="pln">getRemoteDevice</span><span class="pun">(</span><span class="pln">address</span><span class="pun">);</span><span class="pln"><br>mSocket </span><span class="pun">=</span><span class="pln"> device</span><span class="pun">.</span><span class="pln">createInsecureRfcommSocketToServiceRecord</span><span class="pun">(</span><span class="pln">ADK_UUID</span><span class="pun">);</span><span class="pln"><br>mSocket</span><span class="pun">.</span><span class="pln">connect</span><span class="pun">();</span></pre>

<p>Note the <code>ADK_UUID</code> parameter in the second line. This identifier must match the identifier
output by the accessory (the <code>BT_ADK_UUID</code> variable mentioned earlier), otherwise the protocol
negotiation fails and the <code><a href="http://developer.android.com/reference/android/bluetooth/BluetoothSocket.html">BluetoothSocket</a></code> is not created. Once a
connection is established, you obtain <code><a href="http://developer.android.com/reference/java/io/InputStream.html">InputStream</a></code> and <code><a href="http://developer.android.com/reference/java/io/OutputStream.html">OutputStream</a></code>
objects from the socket to communicate with the accessory:</p>

<pre class="prettyprint"><span class="pln">mInStream </span><span class="pun">=</span><span class="pln"> mSocket</span><span class="pun">.</span><span class="pln">getInputStream</span><span class="pun">();</span><span class="pln"><br>mOutStream </span><span class="pun">=</span><span class="pln"> mSocket</span><span class="pun">.</span><span class="pln">getOutputStream</span><span class="pun">();</span></pre>

<p>Review the <code>BTConnection.java</code> file provided in the ADK 2012 software download for more
implementation details.</p>

<h3 id="adk-conn-usb">ADK Connection over USB</h3>

<p>The ADK 2012 app and hardware accessory can also use a USB connection to communicate, similar to
the original ADK.</p>

<h4 id="acc-usb-code">Accessory USB Code</h4>

<p>The ADK library takes care of most of the implementation details for a USB connection, the
accessory code must make a few calls to initialize USB connectivity, including setting the accessory
identification strings:</p>

<pre class="prettyprint"><span class="pln">ADK L</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">void</span><span class="pln"> setup</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; L</span><span class="pun">.</span><span class="pln">adkInit</span><span class="pun">();</span><span class="pln"><br>&nbsp; L</span><span class="pun">.</span><span class="pln">usbSetAccessoryStringVendor</span><span class="pun">(...);</span><span class="pln"><br>&nbsp; L</span><span class="pun">.</span><span class="pln">usbSetAccessoryStringName</span><span class="pun">(...);</span><span class="pln"><br>&nbsp; L</span><span class="pun">.</span><span class="pln">usbSetAccessoryStringLongname</span><span class="pun">(...);</span><span class="pln"><br>&nbsp; L</span><span class="pun">.</span><span class="pln">usbSetAccessoryStringVersion</span><span class="pun">(...);</span><span class="pln"><br>&nbsp; L</span><span class="pun">.</span><span class="pln">usbSetAccessoryStringUrl</span><span class="pun">(...);</span><span class="pln"><br>&nbsp; L</span><span class="pun">.</span><span class="pln">usbSetAccessoryStringSerial</span><span class="pun">(...);</span><span class="pln"><br><br>&nbsp; L</span><span class="pun">.</span><span class="pln">usbStart</span><span class="pun">();</span><span class="pln"><br></span><span class="pun">}</span></pre>

<p class="note"><strong>Note:</strong> The identification strings must match the USB accessory
filter settings specified in the connecting Android application,otherwise the application cannot
connect with the accessory.</p>

<p>Once USB is enabled with code shown above, the accessory listens for connection requests. The ADK
library handles listening and connection details, so the accessory calls <code>ADK::adkEventProcess()</code> once during each loop execution:</p>

<pre class="prettyprint"><span class="kwd">void</span><span class="pln"> loop</span><span class="pun">(</span><span class="kwd">void</span><span class="pun">)</span><span class="pln"><br></span><span class="pun">{</span><span class="pln"><br>&nbsp; </span><span class="pun">...</span><span class="pln"><br>&nbsp; L</span><span class="pun">.</span><span class="pln">adkEventProcess</span><span class="pun">();</span><span class="pln"> </span><span class="com">//let the adk framework do its thing</span><span class="pln"><br>&nbsp; </span><span class="pun">...</span><span class="pln"><br></span><span class="pun">}</span></pre>

<p>The accessory must then check for a live USB connection to process commands and send
messages. Here is a summary of the relevant code:</p>

<pre class="prettyprint"><span class="kwd">void</span><span class="pln"> loop</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">L</span><span class="pun">.</span><span class="pln">accessoryConnected</span><span class="pun">())</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">int</span><span class="pln"> recvLen </span><span class="pun">=</span><span class="pln"> L</span><span class="pun">.</span><span class="pln">accessoryReceive</span><span class="pun">(</span><span class="pln">msg</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">sizeof</span><span class="pun">(</span><span class="pln">msg</span><span class="pun">));</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">recvLen </span><span class="pun">&gt;</span><span class="pln"> </span><span class="lit">0</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; </span><span class="pun">...</span><span class="pln"> </span><span class="com">// process message</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="pun">}</span><span class="pln"><br><br>&nbsp; &nbsp; L</span><span class="pun">.</span><span class="pln">accessorySend</span><span class="pun">(</span><span class="pln">outmsg</span><span class="pun">,</span><span class="pln"> outmsgLen</span><span class="pun">);</span><span class="pln"><br>&nbsp; </span><span class="pun">}</span><span class="pln"><br>&nbsp; L</span><span class="pun">.</span><span class="pln">adkEventProcess</span><span class="pun">();</span><span class="pln"><br></span><span class="pun">}</span></pre>

<p>For more details, review the implementations of these methods in the <code>clock.ino</code>
sketch.</p>

<h4 id="app-usb-code">Android App USB Code</h4>

<p>In the ADK 2012 Android app, the code for handling USB connections is encapsulated in a
<code>UsbConnection</code> class. This class sets up a <code><a href="http://developer.android.com/reference/android/content/BroadcastReceiver.html">BroadcastReceiver</a></code> to
listen for USB events and then attempts to connect when a matching connection event is received.
Here is a summary of the relevant code:</p>

<pre class="prettyprint"><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">android</span><span class="pun">.</span><span class="pln">future</span><span class="pun">.</span><span class="pln">usb</span><span class="pun">.</span><span class="typ">UsbAccessory</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> com</span><span class="pun">.</span><span class="pln">android</span><span class="pun">.</span><span class="pln">future</span><span class="pun">.</span><span class="pln">usb</span><span class="pun">.</span><span class="typ">UsbManager</span><span class="pun">;</span><span class="pln"><br><br>mUSBManager </span><span class="pun">=</span><span class="pln"> </span><span class="typ">UsbManager</span><span class="pun">.</span><span class="pln">getInstance</span><span class="pun">(</span><span class="kwd">this</span><span class="pun">);</span><span class="pln"><br></span><span class="typ">UsbAccessory</span><span class="pln"> acc </span><span class="pun">=</span><span class="pln"> mUSBManager</span><span class="pun">.</span><span class="pln">getAccessoryList</span><span class="pun">()[</span><span class="lit">0</span><span class="pun">];</span><span class="pln"><br><br></span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(!</span><span class="pln">mUSBManager</span><span class="pun">.</span><span class="pln">hasPermission</span><span class="pun">(</span><span class="pln">acc</span><span class="pun">))</span><span class="pln"> </span><span class="kwd">return</span><span class="pun">;</span></pre>

<p>The ADK 2012 app uses the support library to implement the USB accessory connections, in order to
support devices running Android 2.3.4 (API Level 10). If you only need to support Android
3.1 (API Level 12) and higher devices, you can replace the first 4 lines the following code:</p>

<pre class="prettyprint"><span class="kwd">import</span><span class="pln"> android</span><span class="pun">.</span><span class="pln">hardware</span><span class="pun">.</span><span class="pln">usb</span><span class="pun">.</span><span class="typ">UsbAccessory</span><span class="pln"><br></span><span class="kwd">import</span><span class="pln"> android</span><span class="pun">.</span><span class="pln">hardware</span><span class="pun">.</span><span class="pln">usb</span><span class="pun">.</span><span class="typ">UsbManager</span><span class="pln"><br><br>mUSBManager </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="typ">UsbManager</span><span class="pun">)</span><span class="pln"> getSystemService</span><span class="pun">(</span><span class="typ">Context</span><span class="pun">.</span><span class="pln">USB_SERVICE</span><span class="pun">);</span><span class="pln"><br></span><span class="typ">UsbAccessory</span><span class="pln"> acc </span><span class="pun">=</span><span class="pln"> </span><span class="pun">(</span><span class="typ">UsbAccessory</span><span class="pun">)</span><span class="pln"><br>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;intent</span><span class="pun">.</span><span class="pln">getParcelableExtra</span><span class="pun">(</span><span class="typ">UsbManager</span><span class="pun">.</span><span class="pln">EXTRA_ACCESSORY</span><span class="pun">);</span></pre>

<p>Note that the app only receives events when the USB accessory identification information matches
the information in the <code>res/xml/usb_accessory_filter.xml</code> file, referenced by the
application’s manifest statement:</p>

<pre class="prettyprint"><span class="tag">&lt;meta-data</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="atn">android:name</span><span class="pun">=</span><span class="atv">"android.hardware.usb.action.USB_ACCESSORY_ATTACHED"</span><span class="pln"><br>&nbsp; &nbsp; </span><span class="atn">android:resource</span><span class="pun">=</span><span class="atv">"@xml/usb_accessory_filter"</span><span class="pln"> </span><span class="tag">/&gt;</span></pre>

<p>Connections from other USB devices are not received by the ADK 2012 accessory.</p>

<p>Once the connection is established, the app can communicate with the accessory through file input
and output streams, as shown in the following example code:</p>

<pre class="prettyprint"><span class="typ">ParcelFileDescriptor</span><span class="pln"> mFD </span><span class="pun">=</span><span class="pln"> mUSBManager</span><span class="pun">.</span><span class="pln">openAccessory</span><span class="pun">(</span><span class="pln">acc</span><span class="pun">);</span><span class="pln"><br></span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">mFD </span><span class="pun">!=</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; </span><span class="typ">FileDescripter</span><span class="pln"> fd </span><span class="pun">=</span><span class="pln"> mFD</span><span class="pun">.</span><span class="pln">getFileDescriptor</span><span class="pun">();</span><span class="pln"><br>&nbsp; mIS </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">FileInputStream</span><span class="pun">(</span><span class="pln">fd</span><span class="pun">);</span><span class="pln"> &nbsp;</span><span class="com">// use this to receive messages</span><span class="pln"><br>&nbsp; mOS </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">FileOutputStream</span><span class="pun">(</span><span class="pln">fd</span><span class="pun">);</span><span class="pln"> </span><span class="com">// use this to send commands</span><span class="pln"><br></span><span class="pun">}</span></pre>

<p>Review the <code>UsbConnection.java</code> file provided in the ADK 2012 source code for more
implementation details.</p>

<h2 id="audio-dock" style="margin-bottom: 0px;">USB Audio Dock Implementation</h2><hr>

<p>One of the important new features introduced with the ADK 2012 is the ability to play audio over
a USB connection. This innovation was introduced as an update to Android Open Accessory (AOA)
<a href="http://source.android.com/tech/accessories/aoap/aoa2.html">protocol 2.0</a> and is
available on devices running Android 4.1 (API Level 16) and higher.</p>

<p>The ADK 2012 provides a reference implementation of this functionality for accessory developers.
No software application is required to be installed on the connected Android device, accessory
developers only need to support AOA v2. This implementation demonstrates audio output of 16bit,
44.1kHz stereo PCM source data compressed into a single channel due to the audio hardware available
on the accessory.</p>

<p>Using the audio output features provided by the ADK library requires only a few function calls.
The first few calls are in the accessory <code>setup()</code> routine, which prepare the accessory for
USB connections and audio output, as summarized in the code example below:</p>

<pre class="prettyprint"><span class="pln">ADK L</span><span class="pun">;</span><span class="pln"><br></span><span class="kwd">void</span><span class="pln"> setup</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span><span class="pln"><br>&nbsp; L</span><span class="pun">.</span><span class="pln">audioInit</span><span class="pun">();</span><span class="pln"><br>&nbsp; L</span><span class="pun">.</span><span class="pln">usbh_init</span><span class="pun">()</span><span class="pln"><br>&nbsp; L</span><span class="pun">.</span><span class="pln">usbStart</span><span class="pun">();</span><span class="pln"><br></span><span class="pun">}</span></pre>

<p>For more information about the <code>ADK::audioInit()</code> function, see the <code>libraries/ADK/Audio.c</code> library file. For more information about the <code>ADK::usbh_init()</code>
function, see the <code>libraries/ADK/Usbh.c</code> library file.</p>

<p>After completing this setup, the <code>loop()</code> function calls <code>ADK::adkEventProcess()</code> to
handle audio output and other ADK functions:</p>

<pre class="prettyprint"><span class="kwd">void</span><span class="pln"> loop</span><span class="pun">(</span><span class="kwd">void</span><span class="pun">)</span><span class="pln"><br></span><span class="pun">{</span><span class="pln"><br>&nbsp; </span><span class="pun">...</span><span class="pln"><br>&nbsp; L</span><span class="pun">.</span><span class="pln">adkEventProcess</span><span class="pun">();</span><span class="pln"> </span><span class="com">//let the adk framework do its thing</span><span class="pln"><br>&nbsp; </span><span class="pun">...</span><span class="pln"><br></span><span class="pun">}</span></pre>

<p>This call executes task queuing for the ADK and as part of the execution process, the task queue
executes <code>usbh_work()</code> in <code>libraries/ADK/Usbh.c</code>, which handles audio output requests.
Review the implementation of this function for details. For additional implementation details on
audio output, see the <code>libraries/ADK/accessory.c</code> library file.</p>

    </div>
      
      <div class="content-footer layout-content-row" itemscope="" itemtype="http://schema.org/SiteNavigationElement">
        <div class="layout-content-col col-9" style="padding-top:4px">
          
            <div id="___plusone_0" style="text-indent: 0px; margin: 0px; padding: 0px; background-color: transparent; border-style: none; float: none; line-height: normal; font-size: 1px; vertical-align: baseline; display: inline-block; width: 90px; height: 20px; background-position: initial initial; background-repeat: initial initial;"><iframe frameborder="0" hspace="0" marginheight="0" marginwidth="0" scrolling="no" style="position: static; top: 0px; width: 90px; margin: 0px; border-style: none; left: 0px; visibility: visible; height: 20px;" tabindex="0" vspace="0" width="100%" id="I0_1371372612065" name="I0_1371372612065" src="./Accessory Development Kit 2012 Guide   Android Developers_files/fastbutton.html" allowtransparency="true" data-gapiattached="true" title="+1"></iframe></div>
          
        </div>
        
        <div class="paging-links layout-content-col col-4">
          
        </div>
        
      </div>
      
      
      

  </div> <!-- end jd-content -->

<div id="footer" class="wrap">
        

  <div id="copyright">
    
  Except as noted, this content is 
  licensed under <a href="http://creativecommons.org/licenses/by/2.5/">
  Creative Commons Attribution 2.5</a>. For details and 
  restrictions, see the <a href="http://developer.android.com/license.html">Content 
  License</a>.
  </div>


  <div id="footerlinks">
    
  <p>
    <a href="http://developer.android.com/about/index.html">About Android</a>&nbsp;&nbsp;|&nbsp;
    <a href="http://developer.android.com/legal.html">Legal</a>&nbsp;&nbsp;|&nbsp;
    <a href="http://developer.android.com/support.html">Support</a>
  </p>
  </div>

</div> <!-- end footer -->
</div><!-- end doc-content -->

</div> <!-- end body-content --> 











<script id="hiddenlpsubmitdiv" style="display: none;"></script><script>try{for(var lastpass_iter=0; lastpass_iter < document.forms.length; lastpass_iter++){ var lastpass_f = document.forms[lastpass_iter]; if(typeof(lastpass_f.lpsubmitorig2)=="undefined"){ lastpass_f.lpsubmitorig2 = lastpass_f.submit; lastpass_f.submit = function(){ var form=this; var customEvent = document.createEvent("Event"); customEvent.initEvent("lpCustomEvent", true, true); var d = document.getElementById("hiddenlpsubmitdiv"); for(var i = 0; i < document.forms.length; i++){ if(document.forms[i]==form){ d.innerText=i; } } d.dispatchEvent(customEvent); form.lpsubmitorig2(); } } }}catch(e){}</script></body></html>